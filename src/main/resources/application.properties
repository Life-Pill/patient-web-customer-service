# LifePill Patient Customer Service Configuration
# Optional config import for local development
spring.config.import=optional:file:env.properties

# Application name for Eureka registration
spring.application.name=CUSTOMER-SERVICE

# Database configuration
spring.datasource.url=${DB_DATABASE_URL:jdbc:postgresql://localhost:5432/customer_service_db}
spring.datasource.username=${DB_USERNAME:postgres}
spring.datasource.password=${DB_PASSWORD:postgres}
spring.datasource.driver-class-name=org.postgresql.Driver
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=5

# JPA/Hibernate configuration
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.hibernate.ddl-auto=${JPA_DDL_AUTO:update}
spring.jpa.show-sql=${JPA_SHOW_SQL:false}
spring.jpa.properties.hibernate.format_sql=true

# Flyway Migration Configuration
spring.flyway.enabled=${FLYWAY_ENABLED:false}
spring.flyway.locations=classpath:db/migration
spring.flyway.baseline-on-migrate=${FLYWAY_BASELINE:true}

# MongoDB Configuration
spring.data.mongodb.uri=${MDB_CONNECTION_STRING:}

# File Upload Configuration
spring.servlet.multipart.enabled=true
spring.servlet.multipart.max-file-size=200MB
spring.servlet.multipart.max-request-size=200MB

# Stripe Configuration
stripe.api.key=${STRIPE_SECRET_KEY:}

# Server configuration
server.port=${PORT:8070}

# Eureka Client Configuration (Service Discovery)
eureka.client.service-url.defaultZone=${EUREKA_URI:http://localhost:8761/eureka/}
eureka.client.register-with-eureka=${EUREKA_REGISTER:true}
eureka.client.fetch-registry=${EUREKA_FETCH_REGISTRY:true}
eureka.instance.hostname=${HOSTNAME:localhost}
eureka.instance.prefer-ip-address=${EUREKA_PREFER_IP:true}
eureka.instance.instance-id=${spring.application.name}:${server.port}:${random.value}
eureka.instance.health-check-url-path=/actuator/health
eureka.instance.status-page-url-path=/actuator/info

# Actuator configuration
management.endpoints.web.exposure.include=health,info,metrics,prometheus
management.endpoints.web.base-path=/actuator
management.endpoint.health.show-details=when-authorized
management.endpoint.health.probes.enabled=true
management.health.defaults.enabled=true
management.metrics.tags.application=${spring.application.name}
management.metrics.tags.environment=${ENVIRONMENT:development}

# Distributed Tracing with Zipkin
management.tracing.enabled=${TRACING_ENABLED:true}
management.tracing.sampling.probability=${TRACING_SAMPLING_PROBABILITY:1.0}
management.zipkin.tracing.endpoint=${ZIPKIN_ENDPOINT:http://localhost:9411/api/v2/spans}

# SpringDoc OpenAPI Configuration
springdoc.api-docs.enabled=true
springdoc.api-docs.path=/v3/api-docs
springdoc.swagger-ui.enabled=true
springdoc.swagger-ui.path=/swagger-ui.html
springdoc.swagger-ui.operations-sorter=method
springdoc.swagger-ui.tags-sorter=alpha
springdoc.swagger-ui.try-it-out-enabled=true
springdoc.swagger-ui.filter=true

# Swagger Server Configuration
swagger.server.url=${CUSTOMER_SERVICE_SWAGGER_URL:}

# Logging Configuration
logging.level.root=${LOG_LEVEL_ROOT:INFO}
logging.level.com.lifepill.customerservice=${LOG_LEVEL_APP:DEBUG}
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} [%X{traceId:-},%X{spanId:-}] %-5level %logger{36} - %msg%n
logging.file.name=${LOG_PATH:./logs}/customer-service.log

# CORS Configuration
cors.allowed-origins=${CORS_ORIGINS:*}
cors.allowed-methods=${CORS_METHODS:GET,POST,PUT,DELETE,OPTIONS,PATCH}
cors.allowed-headers=${CORS_HEADERS:*}
cors.allow-credentials=${CORS_ALLOW_CREDENTIALS:false}
cors.max-age=${CORS_MAX_AGE:86400}